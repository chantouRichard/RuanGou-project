<Page x:Class="frontend.Views.Pages.UserPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:frontend.Views.Pages"
      mc:Ignorable="d" 
      d:DesignHeight="500" d:DesignWidth="700"
      Title="User Profile"
      Background="#F5F9FF">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 顶部标题 -->
        <TextBlock Text="User Profile"
                   FontSize="24"
                   FontWeight="Bold"
                   Foreground="#1A3B7B"
                   Margin="0,0,0,20"/>

        <!-- 主内容区 -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- 用户头像区域（简化版） -->
            <Border Grid.Column="0" 
                    Width="120" 
                    Height="120"
                    Margin="0,0,30,0"
                    CornerRadius="60"
                    Background="#E6F0FF"
                    BorderBrush="#4D8DFF"
                    BorderThickness="3">
                <Image Source="{Binding CurrentUser.ImageSource, TargetNullValue=/Assets/DefaultIcon.png}"
                       Stretch="UniformToFill">
                    <Image.Clip>
                        <EllipseGeometry Center="60,60" RadiusX="60" RadiusY="60"/>
                    </Image.Clip>
                </Image>
            </Border>

            <!-- 用户信息编辑区（简化版） -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <!-- 用户名 -->
                <StackPanel Margin="0,0,0,15">
                    <TextBlock Text="Username" 
                               Foreground="#4D8DFF"
                               Margin="0,0,0,2"/>
                    <TextBox Text="{Binding CurrentUser.Username, UpdateSourceTrigger=PropertyChanged}"
                             Padding="8"
                             Width="300"
                             BorderBrush="#A0B8E0"/>
                </StackPanel>

                <!-- 邮箱 -->
                <StackPanel Margin="0,0,0,15">
                    <TextBlock Text="Email" 
                               Foreground="#4D8DFF"
                               Margin="0,0,0,2"/>
                    <TextBox Text="{Binding CurrentUser.Email, UpdateSourceTrigger=PropertyChanged}"
                             Padding="8"
                             Width="300"
                             BorderBrush="#A0B8E0"/>
                </StackPanel>

                <!-- 密码 -->
                <StackPanel Margin="0,0,0,20">
                    <TextBlock Text="New Password" 
                               Foreground="#4D8DFF"
                               Margin="0,0,0,2"/>
                    <PasswordBox Padding="8"
             Width="300"
             BorderBrush="#A0B8E0"
             Tag="{Binding RelativeSource={RelativeSource AncestorType=Page}}"/>
                </StackPanel>

                <!-- 注册日期 -->
                <TextBlock Text="{Binding CurrentUser.CreatedAt, StringFormat='Member since {0:MMMM yyyy}'}"
                           FontSize="13"
                           Foreground="#6E7F99"/>
            </StackPanel>
        </Grid>

        <!-- 底部操作按钮（简化版） -->
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Margin="0,20,0,0">
            <Button Content="Save Changes"
                    Width="120"
                    Height="36"
                    Background="#4D8DFF"
                    Foreground="White"
                    BorderThickness="0"
                    Command="{Binding SaveCommand}"
                    Margin="0,0,10,0">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="4"/>
                    </Style>
                </Button.Resources>
            </Button>

            <Button Content="Change Avatar"
                    Width="120"
                    Height="36"
                    Foreground="#4D8DFF"
                    Background="Transparent"
                    BorderBrush="#4D8DFF"
                    BorderThickness="1"
                    Command="{Binding ChangeAvatarCommand}">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="4"/>
                    </Style>
                </Button.Resources>
            </Button>
        </StackPanel>
    </Grid>
</Page>